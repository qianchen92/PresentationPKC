
\begin{frame}{Building blocks}
  \begin{block}{Three building blocks for our Structure-Preserving CCA and RCCA scheme:}
    \begin{enumerate}
    \item Groth-Sahai Proof System 
    \item Structure-Preserving Commitment.
    \item Linearly Homomorphic Structure-Preserving Signature.
    \end{enumerate}
  \end{block}
\end{frame}


\begin{frame}{Groth-Sahai Proof System}
  \begin{block}{Proof Instance: Pairing Product Equation (PPE)}
    \begin{align*}
      \prod^{n}_{j=1} e(\mathcal{A}_j, \mathcal{Y}_j) \prod^{m}_{i=1}e(\mathcal{X}_i, \mathcal{B}_i)\prod^{m}_{i=1} \prod^{n}_{j=1}e(\mathcal{X}_i, \mathcal{Y}_j)^{\gamma_{i,j}} &= t_T
    \end{align*}
    Where for $i \in \{1, \dots, m\}$ and $j \in \{1, \dots, n\}$
    \begin{enumerate}
    \item $\mathcal{X}_i$ variables in $\G$, $\mathcal{Y}_j$ variables in $\hat{\G}$.
    \item $\mathcal{A}_j$ constants in $\G$, $\mathcal{B}_i$ constants in $\hat{\G}$, $t_T$ constant in $\G_T$.
    \end{enumerate}
    $\mathcal{X}_i, \mathcal{Y}_j$ are variables in $\G$ and $\hat{\G}$, respectively, and $\mathcal{A}_j \in \G, \mathcal{B}_i \in \hat{\G}$ and $t_T \in \G_T$ are constants.
  \end{block}
  
\end{frame}

\begin{frame}{Groth-Sahai Proof System}
%  \begin{block}{Framework}
%    \begin{itemize}
%    \item $\Setup(\lambda) \to CRS$
%    \item $\Prove(CRS, (x, w)) \to \pi$
%    \item $\Verif(CRS, (x,w), \pi) \to \{\True, \False\}$
%    \end{itemize}
%  \end{block}

  A non-interactive zero-knowledge proof system $(\Setup, \Prove, \Verif)$:
  \pause
  \begin{itemize}
  \item Prove pairing product equations.
    \pause
  \item {\color{blue}Operate in two modes}: soundness setting and witness indistinguishable setting depending on the common reference string (CRS). Which is consists of four vectors of group elements $(\vec{u}_1, \vec{u}_2, \hat{\vec{u}}_1, \hat{\vec{u}}_2) \in \G^2 \times \G^2 \times \hat{\G}^2 \times \hat{\G}^2$.
    \pause
  	\begin{itemize}
  	\item  {\color{blue}(Soundness setting)} Exists $\zeta, \hat{\zeta} \in \mathbb{Z}_p$ such that $\vec{u}_2 = \vec{u}_1^\zeta$ and $\hat{\vec{u}}_2 = \hat{\vec{u}}_1^{\hat{\zeta}}$. We can use the $\zeta, \hat{\zeta}$ to simulate a proof for false statement and extract the witness from a valid proof.
          \pause
  	\item {\color{blue}(Witness indistinguishable setting)} $(\vec{u}_1, \vec{u}_2)$ and $(\hat{\vec{u}}_1,  \hat{\vec{u}}_2)$ are pairwise independent. Cannot prove false statement and the proofs using different valid witnesses are indistinguishable.
  	\end{itemize}
  \end{itemize}
  
%  \pause
%  \begin{block}{Example}
%    \begin{itemize}
%    \item $\Setup(\lambda)$:  $(\G, \hat{\G}, \G_T)$ of prime order $p > 2^\lambda$ with generators $(g,\hat{g}) \sample \G \times \hat{\G}$, $\vec{u}_1, \vec{u}_2 \sample \G^2$.
%    \item $\Prove(CRS, (x, w))$: 
%    \item $\Verif(CRS, (x,w), \pi) \to \{\True, \False\}$
%    \end{itemize}
%  \end{block}
\end{frame}





\begin{frame}{Strictly Structure-Preserving Commitment~\cite{DBLP:conf/eurocrypt/AbeKOT15}}

	Structure-Preserving Commitment $(\Setup, \Com, \Verif)$ which has the following properties.\pause
%  \begin{block}{Framework}
%      \begin{itemize}
%      \item $\Setup(\lambda) \to \ck$: Generates commitment key $\ck$.
%      \item $\Com(\ck, m; \open) \to (\com,\open)$: Generates a commitment $\com$ \wrt the randomness $\open$.
%      \item $\Verif(\ck, m, \com, \open) \to \{True, False\}$: Outputs convinced or not.
%      \end{itemize}
%  \end{block}
%\end{frame}
%\begin{frame}{Strictly Structure-Preserving Commitment~\cite{DBLP:conf/eurocrypt/AbeKOT15}}
  \begin{block}{Properties}
    \begin{itemize}
      %    \item (Binding) No (PPT)adversary can produce $(m, m', \open, \open', \com)$ \st $\Verif(\ck, m, \com, \open) = \True$ and $\Verif(\ck, m', \com, \open') = \True$ and $m \neq m'$
      %    \item (Hiding)
    \item {\color{blue}(Correctness)} $\Verif(\ck, m, \Com(\ck, m; \open), \open) = \True$.
      \pause
    \item {\color{blue}(Enhanced Chosen-Message Target Collision Resistant (ECM-TCR))} Given $\com^*, m^*, \open^*$ a valid commitment. Hard to generate $(m, \open)$ \st
      \begin{align*}
        \Verif(\ck, m, \com^*, \open) &= \True \wedge (m, \open) \neq (m^*, \open^*)
      \end{align*}
    \end{itemize}
  \end{block}


\end{frame}


\begin{frame}{Linearly Homomorphic Structure-Preserving Signature}
  \begin{block}{Framework}
  \begin{itemize}
  \item $\boldmath{\Setup(\lambda) \to \PPP}$: Generates the public parameter $\PPP$.
  \item $\boldmath{\KeyGen(\PPP) \to (\SK, \VK)}$: Generates the signing key $\SK$ and the verification key $\VK$.
  \item $\boldmath{\Sig(\PPP, \SK, \vec{M} = \{\vec{m}_i\}_{i=1}^k) \to \vec{\sigma} = \{\vec{\sigma}_i\}_{i=1}^k}$: Outputs a set of signatures $\vec{\sigma} = \{\vec{\sigma}_i\}_{i=1}^k$.
  \item $\boldmath{\Verif(\PPP, \VK, \vec{m}, \vec{\sigma}) \to \{\True, \False\}}$
  \end{itemize}
  \end{block}
\end{frame}

\begin{frame}{Linearly Homomorphic Structure-Preserving Signature}
  \begin{block}{Linearly homomorphic}
    \begin{enumerate}
    \item Signatures $\vec{\sigma}_i = (\sigma_{i,1}, \sigma_{i,2}, \sigma_{i,3}) \in \G^3$ of the message $\vec{m}_i = (m_{i,1}, \dots, m_{i,k}) \in \G^k$.
    \item Random values $\lambda_1, \dots, \lambda_k \in \mathbb{Z}_p$.
    \item New signature
      \begin{align*}
        \vec{\sigma}' &= (\prod_{i = 1}^k \sigma_{i,1}^{\lambda_i}, \prod_{i = 1}^k \sigma_{i,2}^{\lambda_i}, \prod_{i = 1}^k \sigma_{i,2}^{\lambda_i}) & \vec{m}' &= (\prod_{i = 1}^km_{i,1}^{\lambda_i}, \dots, \prod_{i = 1}^km_{i,k}^{\lambda_i})
      \end{align*}
    \end{enumerate}
  \end{block}
  
\end{frame}
